<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/themes/prism.min.css">
</head>
<body class="h-full bg-gray-50 flex flex-col">
    <header class="bg-white shadow-sm">
        <div class="blog-container">
            <div class="blog-nav">
                <h1 class="text-2xl font-bold text-gray-900">
                    <a href="/" class="hover:text-blue-600 transition-colors">My Blog</a>
                </h1>
                <nav class="blog-nav-links">
                    <a href="/" class="blog-nav-link <%= currentPage === 'home' ? 'text-blue-600' : '' %>">Home</a>
                    <a href="/posts" class="blog-nav-link <%= currentPage === 'posts' ? 'text-blue-600' : '' %>">Posts</a>
                    <a href="/about" class="blog-nav-link">About</a>
                </nav>
            </div>
        </div>
    </header>
    
    <main class="flex-1">
<div class="blog-container">
    <article class="max-w-4xl mx-auto">
        <header class="mb-8">
            <div class="mb-4">
                <a href="/" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                    ← Back to Home
                </a>
            </div>
            
            <h1 class="text-4xl font-bold text-gray-900 mb-4 leading-tight">
                <%= post.meta.title %>
            </h1>
            
            <div class="flex flex-wrap items-center gap-4 text-sm text-gray-600">
                <time datetime="<%= post.meta.date %>">
                    <%= new Date(post.meta.date).toLocaleDateString('en-US', { 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric' 
                    }) %>
                </time>
                
                <span>·</span>
                <span><%= post.readingTime %> min read</span>
                
                <% if (post.meta.author) { %>
                    <span>·</span>
                    <span>by <%= post.meta.author %></span>
                <% } %>
                
                <% if (post.meta.tags && post.meta.tags.length > 0) { %>
                    <span>·</span>
                    <div class="flex flex-wrap gap-2">
                        <% post.meta.tags.forEach(tag => { %>
                            <a href="/labeled/<%= tag.toLowerCase() %>" 
                               class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors">
                                <%= tag %>
                            </a>
                        <% }); %>
                    </div>
                <% } %>
            </div>
        </header>
        
        <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-p:text-gray-700 prose-a:text-blue-600 prose-strong:text-gray-900 prose-code:text-pink-600 prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-blockquote:border-blue-500 prose-blockquote:bg-blue-50 prose-blockquote:p-4">
            <%- post.content %>
        </div>
        
        <footer class="mt-12 pt-8 border-t border-gray-200">
            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center">
                <div class="mb-4 sm:mb-0">
                    <p class="text-sm text-gray-600">
                        Published on 
                        <time datetime="<%= post.meta.date %>">
                            <%= new Date(post.meta.date).toLocaleDateString('en-US', { 
                                year: 'numeric', 
                                month: 'long', 
                                day: 'numeric' 
                            }) %>
                        </time>
                    </p>
                </div>
                
                <div class="flex space-x-4">
                    <a href="/" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                        ← More posts
                    </a>
                </div>
            </div>
        </footer>
    </article>
</div>
    </main>
    
    <footer class="bg-white border-t border-gray-200 mt-12">
        <div class="blog-container">
            <div class="blog-footer">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <p class="text-gray-600 mb-4 md:mb-0">&copy; 2025 My Blog. Built with Koa.js and Tailwind CSS.</p>
                    <div class="flex space-x-4">
                        <a href="/feed.xml" class="text-gray-500 hover:text-gray-700 transition-colors">RSS</a>
                        <a href="/sitemap.xml" class="text-gray-500 hover:text-gray-700 transition-colors">Sitemap</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Copy code functionality
        document.addEventListener('DOMContentLoaded', function() {
            const copyButtons = document.querySelectorAll('.copy-code-btn');
            
            copyButtons.forEach(button => {
                button.addEventListener('click', async function() {
                    const codeBlock = this.parentElement.querySelector('code');
                    const text = codeBlock.textContent;
                    
                    try {
                        await navigator.clipboard.writeText(text);
                        const originalText = this.textContent;
                        this.textContent = 'Copied!';
                        this.classList.add('bg-green-600');
                        
                        setTimeout(() => {
                            this.textContent = originalText;
                            this.classList.remove('bg-green-600');
                        }, 2000);
                    } catch (err) {
                        console.error('Failed to copy: ', err);
                        this.textContent = 'Failed';
                        setTimeout(() => {
                            this.textContent = 'Copy';
                        }, 2000);
                    }
                });
            });
            
            // Show copy buttons on hover
            const codeWrappers = document.querySelectorAll('.code-block-wrapper');
            codeWrappers.forEach(wrapper => {
                wrapper.addEventListener('mouseenter', function() {
                    const button = this.querySelector('.copy-code-btn');
                    if (button) button.classList.remove('opacity-0');
                });
                
                wrapper.addEventListener('mouseleave', function() {
                    const button = this.querySelector('.copy-code-btn');
                    if (button) button.classList.add('opacity-0');
                });
            });
        });
    </script>
</body>
</html>
